<% template admin_editpost() %>
<script type="text/javascript">
<!--
	/*  Form validation and simple-antispam */
	function testform()
	{
		var form=document.getElementById('inp');
		if(form.title.value.length == 0 || form.<% if is_page %>content<% else %>abstract<% end %>.value.length  == 0)
		{
			<% if is_page %>
			alert('<% gt 'Title and Content are mandatory!' %>');
			<% else %>
			alert('<% gt 'Title and Abstract are mandatory!' %>');
			<% end %>
			return false;
		}
		else {
			return true;
		}
	}
	function switchvis(id)
	{
		val=document.getElementById(id).style.display;
		if(val=='inline') 
			val='none';
		else
			val='inline';
		document.getElementById(id).style.display=val;
	}
-->
</script>
<div id="form">
<% if def post_id %>
<h2><% if is_page %><%gt 'Edit Page No.' %><%else%><% gt 'Edit Post No.' %><% end %><% post_id %></h2>
<p><a href="<% preview_url | raw %>"><% gt 'preview...' %></a></p>
<% else %>
<h2><% if is_page %><%gt 'New Page' %><%else%><% gt 'New Post' %><% end %></h2>
<% end %>

<form id="inp" action="<% submit_post_url | raw %>" method="post" onsubmit="return testform();" >
        <dl>
        <dt><% gt 'Title:'%></dt>
        <dd><input type="text" name="title" size="80" <% if def post_title %>value="<%post_title%>"<% end %> /></dd>
	<% if not is_page %>
	<dt><% gt 'Categories:' %></dt>
	<dd>
		<p>
		<% foreach cat in cats_in %>
		<% gt 'The post is published under catergories:'%>
		<% separator %>, <% item %><% cat.name %><% end %>
		<% empty %>
		<% gt 'No categories assigned to this post.'%>
		<% end %>
		<a href="javascript:switchvis('editcats');"><% gt '(click to edit)' %></a>
		</p>
		<div id="editcats" style="display:none" >
		<% foreach cat in cats_in %>
			<p><strong><% gt 'Remove From Categories:' %></strong></p>
			<ul class="catlist">
			<% item %>
			<li><input type="checkbox" name="del" value="<% cat.id %>"> <% cat.name %></li>
			<% end %>
			</ul>
		<% end %>
		<% foreach cat in cats_out %>
			<p><strong><% gt 'Add To Categories:' %></strong></p>
			<ul class="catlist">
			<% item %>
			<li><input type="checkbox" name="add" value="<% cat.id %>"> <% cat.name %></li>
			<% end %>
			</ul>
		<% end %>
		</div>		
	</dd>
        <dt><% gt 'Abstract:'%></dt>
        <dd>
                <fieldset><div> <!-- IE Textarea ugly hack -->
                        <textarea name="abstract" cols="80" rows="10"><% if def abstract %><% abstract %><% end %></textarea>
                </div></fieldset>
        </dd>
	<% end %>
        <dt><% gt 'Content:' %></dt>
        <dd>
                <fieldset><div> <!-- IE Textarea ugly hack -->
                        <textarea name="content" cols="80" rows="20"><% if def content %><% content %><% end %></textarea>
                </div></fieldset>
        </dd>
        <dd>
                <input type="submit" name="save" value="<% gt 'Save' %>" />
                <input type="submit" name="preview" value="<% gt 'Save and Continue' %>" />
                <% if not is_open %>
               		<input type="submit" name="publish" value="<% gt 'Publish' %>" />
               	<% else %>
               		<input type="submit" name="unpublish" value="<% gt 'Unpublish' %>" />
               	<% end %>
                <% if def post_id %>
                <input type="submit" name="delete" value="<% gt 'Delete' %>"
                	onclick="return confirm('<% gt 'Are you shure?' %>');" />
                <% end %>
        </dd>
        </dl>
</form>
</div>
<% end %>
